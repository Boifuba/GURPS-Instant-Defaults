{"name":"Fatigue","type":"script","author":"rKZhHff41sD8F8Yq","img":"icons/equipment/feet/boots-leather-laced-brown.webp","scope":"global","command":"/*\nOnly works in GURPS Game Aid.(how are you feeling now DnD'ers?)\nSelect your party e click to run the macro. The FP adjustmentes will be made based\non your actual encumbrance. When use it to calculate FP on Hiking, stop the hiking\nand recalculate when the first character is 1/3 FP.\nI hope you enjoy it!\n*/\nlet actors = canvas.tokens.controlled.map((i) => i.actor);\nif (!actors.length)\n  actors = game.users\n    .filter((i) => i.active && !!i.character)\n    .map((i) => i.character);\nfor (const actor of actors) {\n  const encumbrance = actor.data.data.encumbrance;\n  const FP = actor.data.data.FP;\n  const current = Object.values(encumbrance).find((i) => i.current);\n  const key = current.key;\n  const value = actor.data.data.FP.value;\n  if (key === \"enc0\") await actor.update({ \"data.FP.value\": value - 1 });\n  else if (key === \"enc1\") await actor.update({ \"data.FP.value\": value - 2 });\n  else if (key === \"enc2\") await actor.update({ \"data.FP.value\": value - 3 });\n  else if (key === \"enc3\") await actor.update({ \"data.FP.value\": value - 4 });\n  else if (key === \"enc4\") await actor.update({ \"data.FP.value\": value - 5 });\n  ChatMessage.create({content:  `<p>${actor.name} have <b>${FP.value} FP</b></p>`});\n}","folder":null,"sort":0,"permission":{"default":0,"rKZhHff41sD8F8Yq":3},"flags":{"core":{"sourceId":"Macro.E2P570JwpoQEoRPl"}},"_id":"EFHXD21eF2o0vsVC"}
{"name":"Instant Defaults","type":"script","author":"pX25O5PLzpFvPyFD","img":"icons/sundries/flags/banner-yellow.webp","scope":"global","command":"InstantDefaults.skillChooser()","folder":null,"sort":0,"permission":{"default":0,"pX25O5PLzpFvPyFD":3},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.JDV9ZoJ2Q6vQUSql"}},"_id":"IpBzKHCFjXQerZsX"}
{"name":"Falling Calculator","type":"script","author":"rKZhHff41sD8F8Yq","img":"icons/skills/movement/arrow-down-pink.webp","scope":"global","command":"if (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"Select the falling token\");\n\n\n\nconst myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/falling.html\");\n\nnew Dialog({\n  title: \"GURPS Instant Falling Damage\",\n  content: myContent,\n  buttons: {}\n}).render(true);","folder":null,"sort":0,"permission":{"default":0,"rKZhHff41sD8F8Yq":3},"flags":{"core":{"sourceId":"Macro.edXnzxry3c8iIM2p"}},"_id":"KF8VDAY7IXYeOFSu"}
{"name":"Hiking Calculator","type":"script","author":"rKZhHff41sD8F8Yq","img":"icons/skills/movement/feet-winged-sandals-tan.webp","scope":"global","command":"// if (canvas.tokens.controlled.length === 0)\n//   return ui.notifications.error(\"Select the falling token\");\n\nif (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"Select the token leader\");\n\n\n\nconst myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/hiking.html\");\n\nnew Dialog({\n  title: \"GURPS Hiking Calculator\",\n  content: myContent,\n  buttons: {}\n}).render(true);","folder":null,"sort":0,"permission":{"default":0,"rKZhHff41sD8F8Yq":3},"flags":{"core":{"sourceId":"Macro.TbasT3DKsY3L0nec"}},"_id":"Rut3d9IplQu7Mstj"}
{"name":"ReactionRoll","type":"script","author":"pX25O5PLzpFvPyFD","img":"icons/environment/people/group.webp","scope":"global","command":"let r = new Roll(\"3d6 + @mod\", { mod: GURPS.ModifierBucket.currentSum()})\ngame.tables.getName(\"Reaction Rolls\").draw({roll:r})\nGURPS.ModifierBucket.clear()","folder":null,"sort":0,"permission":{"default":0,"fxJ7E4GhCZAfiQvi":3,"pX25O5PLzpFvPyFD":3},"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.BAVCAmeEE34jS0dN"},"importid":"SwxFagE3eJmQSiTu"},"_id":"T4lat5EDOgrcJ3vP"}
{"name":"Healing Tool","type":"script","author":"pX25O5PLzpFvPyFD","img":"icons/magic/holy/chalice-glowing-gold-water.webp","scope":"global","command":"const targets = Array.from(game.user.targets);\n\n//MINOR HEALING\n\n\nfunction minorHealing(energy) {\n  if ((energy > 3)) {\n    ui.notifications.error(\"The value need to be equal or lower than 3\");\n    dialogEditor.render(true);\n        \n \n//  energy = Object.keys(energy).length === 0 {\n//       ui.notifications.error(\"Choose a value between 1-3\");\n      \n      \n\n    } else {\n      \n      \n      GURPS.executeOTF(`/r [/hp +${energy}  @target]`)\n      GURPS.executeOTF(`/r [/fp -${energy}]`)\n    }\n  }\n\n\n  //MAJOR HEALING\n\n\nfunction majorHealing(energy) {\n  if ((canvas.tokens.controlled[0] === 0 & Array.from(game.user.targets)[0] === 0)) {\n    ui.notifications.error(\"You need some energy to cast this spell!\");\n    dialogEditor.render(true);\n\n  } else {\n    let realHealing = energy * 2\n    targets.forEach((target) => {\n    GURPS.executeOTF(`/r [/hp +${realHealing}  @target]`)\n    GURPS.executeOTF(`/r [/fp -${energy}]`);\n    }\n    )};\n  \n\n}\n\n//GREATER HEALING\n\nfunction greaterHealing(energy) {\n\n  GURPS.executeOTF(`/r [/hp reset  @target]`)\n  GURPS.executeOTF(`/r [/fp -20]`)\n}\n\nlet dialogContent =\n` \n\n    <form>\n    <div class=\"form-group\">\n      <label>Fatigue Points:</label>\n      <input id=\"energy\" name=\"energy\" type=\"number\" value=\"1\" min=\"1\" max=\"20\">\n      </div>    \n`\n  ;\n\n//let applyChanges = false\nlet dialogButtons = {\n \n\n  minorHealing: {\n\n    label: `Minor Healing`,\n    callback: async (html) => minorHealing(html.find('#energy').val())\n  },\n  majorHealing: {\n\n    label: `Major Healing`,\n    callback: async (html) => majorHealing(html.find('#energy').val())\n  },\n  greaterHealing: {\n\n    label: `Greater Healing`,\n    callback: async (html) => greaterHealing(html.find('#energy').val())\n  }\n}\n\nlet dialogEditor = new Dialog({\n  title: `Instant Healings`,\n  content: dialogContent,\n  buttons: dialogButtons,\n  default: \"yes\",\n})\n\ndialogEditor.render(true);","folder":null,"sort":0,"permission":{"default":0,"pX25O5PLzpFvPyFD":3},"flags":{"core":{"sourceId":"Macro.npfhk5aF2sMZi0Cg"}},"_id":"TVFAD9kLLT3nl2QG"}
{"name":"Body Parts","type":"script","author":"rKZhHff41sD8F8Yq","img":"modules/gurps-instant-defaults/img/icons/bodyParts/face.png","scope":"global","command":"const managerType = \"Body Parts\";\n\n(() => {\n  const tables = [\n    \"Abdomen\",\n    \"Arm\",\n    \"Chest\",\n    \"Face\",\n    \"Foot\",\n    \"Hand\",\n    \"Leg\",\n    \"Neck\"\n     ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  tables.forEach((str) => {\n    let table = game.tables.getName(str);\n    if (!table) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#bp .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #bp header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#bp .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #bp .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${table.data.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.tables.getName(str).draw();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"bp\" }\n  ).render(true);\n})();","folder":null,"sort":0,"permission":{"default":0,"rKZhHff41sD8F8Yq":3},"flags":{"core":{"sourceId":"Macro.bLIEcmBOaxoJl7yO"}},"_id":"b5jGz6Mg8DgHdPsu"}
{"name":"Apply Manual Damage","type":"script","author":"pX25O5PLzpFvPyFD","img":"icons/skills/wounds/injury-pain-body-orange.webp","scope":"global","command":"function manualDamage(damage, type) {\n  GURPS.executeOTF(`/r [${damage} ${type}]`);\n}\nnew Dialog({\n  title: `Manual Damage`,\n  content: \n`<form>\n<style>\nform#form-group {\n  background-color: red;\n}\n</style>\n <form>\n      <div class=\"form-group\">\n        <label>Damage Type: </label>\n        <select id=\"damageType\" name=\"damageType\">\n          <option value=\"burn\">Burning</option>\n          <option value=\"cor\">Corrosion</option>\n          <option value=\"cr\">Crushing</option>\n          <option value=\"imp\">Impaling</option>\n          <option value=\"pi-\">Smal piercing</option>\n          <option value=\"pi\">Piercing</option>\n          <option value=\"pi+\">Large Piercing</option>\n          <option value=\"pi+\">Large Piercing</option>\n          <option value=\"pi++\">Huge Piercing</option>\n          <option value=\"tox\">Toxic</option>\n          <option value=\"sh\">Shield</option>\n             \n          \n          \n          </select>\n      </div>\n     \n  </form>  \n  \n  <form>\n<div class=\"form-group\">\n  <label>Damage Amount:</label>\n  <input id=\"damageAmount\" name=\"damageAmount\"  value=\"\" min=\"1\" max=\"20\">\n  </div>   \n  `,\n  buttons: {\n    confirm: {\n      label: \"Confirm\",\n      callback: async (html) => {\n        manualDamage(html.find('#damageAmount').val(), html.find('#damageType').val());\n      }\n    }\n  }\n}, {\n  width: 400\n}).render(true);","folder":null,"sort":0,"permission":{"default":0,"pX25O5PLzpFvPyFD":3},"flags":{"core":{"sourceId":"Macro.Bjf1SqGzABywtOTp"}},"_id":"cWucJTpypbC96DpL"}
{"name":"Journal Menu","type":"script","author":"pX25O5PLzpFvPyFD","img":"icons/tools/scribal/ink-quill-pink.webp","scope":"global","command":"const managerType = 'Journal Menu';\n\n(()=>{\n  const journals = [\n    \n    \"Vision\",\n    \"Escudo\"   \n\n  ];\n\n    let buttons = {}, dialog, content = `<div sytle=\"width:100%;text-align:center;><h2>Choose Journal</h2></div>`;\n  \n  \n  journals.forEach((str)=> {\n    let journal = game.journal.getName(str);\n    if(!journal) return;\n\n    buttons[str] = {\n      label : `\n        <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        \n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>`,\n      callback : () => {\n        game.journal.getName(str).sheet.render(true);\n       dialog.render(true);\n      }\n    }\n  });\n  dialog = new Dialog({title : `${managerType}`,content, buttons}).render(true);\n})();","folder":null,"sort":0,"permission":{"default":0,"pX25O5PLzpFvPyFD":3},"flags":{"core":{"sourceId":"Macro.2mBXApLhSAET8wtI"}},"_id":"fpm1y2KEbiCkJRSw"}
{"name":"Compendium Menu","type":"script","author":"pX25O5PLzpFvPyFD","img":"icons/sundries/books/book-embossed-blue.webp","scope":"global","command":"const managerType = 'Compendium Menu';\n\n(()=>{\n  const journals = [\n    \n    \"gurps-instant-defaults.GURPS4E-Basic-Set\" , \n    \"GURPS-Modifier-Tables.tables\",\n    \"gurps-instant-defaults.GURPS4E-Dungeon-Fantasy-RPG\",\n    \"GURPS RollTables\"\n   \n\n  ];\n\n  let path = 'icons/sundries/books/',\nfiles = [\n    'book-backed-silver-gold.webp', \n    'book-worn-brown-grey.webp',\n     'book-worn-blue.webp',\n      'book-symbol-canterbury-cross.webp',\n       'book-symbol-triangle-silver-purple.webp',\n        'book-tooled-silver-blue.webp',\n         'book-symbol-fire-gold-orange.webp',\n          'book-stack.webp',\n           'book-embossed-spiral-purple-white.webp',\n            'book-symbol-leaf-green.webp']\ni = Math.floor(Math.random()*files.length);\nlet imagem = (path+files[i]);\nconsole.log(imagem)\n\n    let buttons = {}, dialog, content = `<div sytle=\"width:100%;text-align:center;><h2>Choose Journal</h2></div>`;\n  \n  \n  journals.forEach((str)=> {\n    let journal = game.packs.get(str);\n    if(!journal) return;\n    const name = journal.metadata.label;\n\n    buttons[str] = {\n      label : `\n        <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        \n        <img src=\"${imagem}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${name}</label></div>\n        </div>`,\n      callback : () => {\n        game.packs.get(str).render(true);\n       dialog.render(true);\n      }\n    }\n  });\n  dialog = new Dialog({title : `${managerType}`,content, buttons}).render(true);\n})();","folder":null,"sort":0,"permission":{"default":0,"pX25O5PLzpFvPyFD":3},"flags":{"core":{"sourceId":"Macro.qsWPXt5DBqz5Yis1"}},"_id":"gPfNLGhPZSb8ZK3I"}
{"name":"Macros Folder","type":"script","author":"rKZhHff41sD8F8Yq","img":"icons/containers/boxes/crate-heavy-yellow.webp","scope":"global","command":"const managerType = \"Macros Folder\";\n\n(() => {\n  const macros = [\n    \"Instant Defaults\",\n    \"Tables Folder\",\n    \"Hiking Calculator\",\n    \"Falling Calculator\",\n    \"Throwing Calculator\",\n    \"Sight Togle\",\n    \"Fatigue\",\n    \"Sight Toggle\",\n    \"Sight Adjustment\",\n    \"Body Parts\",\n    \"Healing Tool\"\n\n  ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  macros.forEach((str) => {\n    let macro = game.macros.getName(str);\n    if (!macro) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#GURPScs .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #GURPScs header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#GURPScs .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #GURPScs .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${macro.data.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.macros.getName(str).execute();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"GURPScs\" }\n  ).render(true);\n})();","folder":null,"sort":0,"permission":{"default":0,"rKZhHff41sD8F8Yq":3},"flags":{"core":{"sourceId":"Macro.ul71YhG3o9fguYNU"}},"_id":"ino0BKWSc97R9AZy"}
{"name":"Sight Toggle","type":"script","author":"pX25O5PLzpFvPyFD","img":"icons/magic/perception/shadow-stealth-eyes-purple.webp","scope":"global","command":"ui.notifications.notify(token.name + \"Select your token again to update your vision \");\nawait token.document.update({sightAngle : token.document.data.sightAngle === 360 ? 275 : 360});\nawait canvas.scene.updateEmbeddedDocuments(\"Token\", updates);","folder":null,"sort":0,"permission":{"default":0,"pX25O5PLzpFvPyFD":3},"flags":{"core":{"sourceId":"Macro.kRKbNVaRiRhyjZOD"}},"_id":"u7rRaD8LiCBCgMCp"}
{"name":"Sight Adjustment","type":"script","author":"rKZhHff41sD8F8Yq","img":"icons/skills/targeting/crosshair-arrowhead-blue.webp","scope":"global","command":"/*\nSelect all tokens to change the size of sight.\nClick on Macro with:\n\nCtrl  = Increase Sight +1\nAlt = decrease Sight -1\n\nOnly Click in the macro you will change your sight by 0\n\n*/\n\n\nconst updates = canvas.tokens.controlled.map(i => {\n  const dimSight = Number(i.document.data.dimSight);\n  const change = event.ctrlKey ? dimSight + 0.8 : event.altKey ? dimSight -1 : 0;\n  return {_id: i.id, dimSight: Math.max(change, 0)};\n});\nawait canvas.scene.updateEmbeddedDocuments(\"Token\", updates);","folder":null,"sort":0,"permission":{"default":0,"pX25O5PLzpFvPyFD":3,"rKZhHff41sD8F8Yq":3},"flags":{"core":{"sourceId":"Macro.x4SKjhUyWSJeecrz"}},"_id":"yQqXRhLgMqGR8js4"}
{"name":"Tables Folder","type":"script","author":"rKZhHff41sD8F8Yq","img":"modules/gurps-instant-defaults/img/icons/critical.png","scope":"global","command":"const managerType = \"Tables Folder\";\n\n(() => {\n  const tables = [\n    \"Critical Head Blow\",\n    \"Critical Hit\",\n    \"Critical Magic\",\n    \"Critical Miss\",\n    \"Critical Unarmed Strike\",\n    \"Reaction Rolls\",\n    \"Sight Toggle\",\n    \"Sight Adjustment\",\n    \"Healing Tool\",\n    \"Body Parts\"\n\n  ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  tables.forEach((str) => {\n    let table = game.tables.getName(str);\n    if (!table) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#tf .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #bp header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#tf .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #tf .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${table.data.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.tables.getName(str).draw();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"tf\" }\n  ).render(true);\n})();","folder":null,"sort":0,"permission":{"default":0,"rKZhHff41sD8F8Yq":3},"flags":{"core":{"sourceId":"Macro.PiqMWUzecRiYnlTN"}},"_id":"z1H3yBmWLs3TFTbt"}
